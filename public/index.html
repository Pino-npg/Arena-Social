<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Î™Ð˜FÎžÐ¯Ð˜Î¦ Î›RÎžNÎ›</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="img/favicon.png" type="image/png">
</head>
<body>
  <div id="game-container">
    <!-- HEADER -->
    <header>
      <div id="rules-btn" class="icon">ðŸ“œ</div>
      <div id="online-box">
        <span id="online">Online: 0</span>
        <div id="music-toggle" class="icon">ðŸŽ§</div>
        <div id="fullscreen-btn" class="icon">ðŸ”²</div>
      </div>
    </header>

    <!-- TITLE -->
    <h1 class="arena-title">Î™Ð˜FÎžÐ¯Ð˜Î¦ Î›RÎžNÎ›</h1>
    <img class="favicon" src="img/favicon.png" alt="favicon">
    <h2 class="subtitle">Abandon all hope, ye who enter here</h2>

    <!-- NICKNAME -->
    <div class="nick-box">
      <input type="text" id="nickname" placeholder="Nickname">
      <button id="confirm-nick">Confirm</button>
    </div>

    <!-- CHARACTERS -->
    <div id="characters" class="char-grid">
      <div class="char" data-char="Beast"><img src="img/Beast.png"></div>
      <div class="char" data-char="Clown"><img src="img/Clown.png"></div>
      <div class="char" data-char="Cyclope"><img src="img/Cyclope.png"></div>
      <div class="char" data-char="Giant"><img src="img/Giant.png"></div>
      <div class="char" data-char="Hero"><img src="img/Hero.png"></div>
      <div class="char" data-char="Kongo"><img src="img/Kongo.png"></div>
      <div class="char" data-char="Pirate"><img src="img/Pirate.png"></div>
      <div class="char" data-char="Sailor"><img src="img/Sailor.png"></div>
      <div class="char" data-char="Taurus"><img src="img/Taurus.png"></div>
      <div class="char" data-char="WereWolf"><img src="img/WereWolf.png"></div>
    </div>

    <!-- MODE -->
    <div id="mode-box">
      <h3>MODE</h3>
      <button id="mode-1vs1" disabled>1vs1</button>
      <button id="mode-tournament" disabled>Tournament 8</button>
    </div>

    <!-- RULES POPUP -->
    <div id="rules-popup" class="hidden">
      <div class="rules-content">
        <h2>Rules</h2>
        <p>
          Each player has 80 health points and deals 1D8 damage.<br>
          An initiative die roll determines who will be the first to strike.<br>
          On 8 damage the opponent is stunned and deals -1 on the next turn.<br>
          Have fun with your favorite character.
        </p>
        <button id="close-rules">Close</button>
      </div>
    </div>
  </div>

  <script>
    // Nickname
    const nicknameInput = document.getElementById("nickname");
    const confirmBtn = document.getElementById("confirm-nick");
    const chars = document.querySelectorAll(".char");
    const mode1 = document.getElementById("mode-1vs1");
    const mode2 = document.getElementById("mode-tournament");
    let nickConfirmed = false;
    let selectedChar = null;

    confirmBtn.onclick = () => {
      if(nicknameInput.value.trim() !== ""){
        nickConfirmed = true;
        confirmBtn.disabled = true;
        nicknameInput.disabled = true;
        alert("Nickname confirmed!");
      }
    };

    chars.forEach(c=>{
      c.onclick = ()=>{
        if(!nickConfirmed) return;
        chars.forEach(el=>el.classList.remove("selected"));
        c.classList.add("selected");
        selectedChar = c.dataset.char;
        mode1.disabled = false;
        mode2.disabled = false;
      };
    });

    // Rules popup
    document.getElementById("rules-btn").onclick = ()=>{
      document.getElementById("rules-popup").classList.remove("hidden");
    };
    document.getElementById("close-rules").onclick = ()=>{
      document.getElementById("rules-popup").classList.add("hidden");
    };

    // Music autoplay
    const music = new Audio("img/8.mp3");
    music.loop = true;
    window.addEventListener("load", () => {
      music.play().catch(()=>console.log("Tap screen to start audio on iOS"));
    });
    document.getElementById("music-toggle").onclick = ()=>{
      if(music.paused) music.play();
      else music.pause();
    };

    // Fullscreen mobile/desktop
    const fullscreenBtn = document.getElementById("fullscreen-btn");
    const container = document.getElementById("game-container");

    fullscreenBtn.addEventListener("click", async () => {
      try {
        if (!document.fullscreenElement) {
          if (container.requestFullscreen) await container.requestFullscreen();
          else if (container.webkitRequestFullscreen) await container.webkitRequestFullscreen();
          else if (container.msRequestFullscreen) await container.msRequestFullscreen();
        } else {
          if (document.exitFullscreen) await document.exitFullscreen();
          else if (document.webkitExitFullscreen) await document.webkitExitFullscreen();
        }
      } catch(err){
        console.log("Fullscreen non supportato su questo dispositivo");
      }
    });
  </script>
</body>
</html>