<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fight Game - Pino</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<h1>Fight Game - Pino Collection</h1>
<div id="onlineCounter">Online: 0</div>

<div class="modeButtons">
  <h3>Select Mode:</h3>
  <button id="walletBtn">Connect Wallet</button>
  <button id="demoBtn">Demo</button>
</div>

<div class="characters-selection" id="characters">
  <img src="img/Beast.png" data-name="Beast" class="selected">
  <img src="img/Clown.png" data-name="Clown">
  <img src="img/Giant.png" data-name="Giant">
  <!-- aggiungi gli altri -->
</div>

<button id="startBtn">Start Battle</button>

<script>
const ws = new WebSocket(`ws://${location.host}`);
const onlineCounter = document.getElementById("onlineCounter");
const startBtn = document.getElementById("startBtn");
let selectedCharacter = "Beast";
let mode = null;

document.querySelectorAll("#characters img").forEach(img => {
  img.addEventListener("click", ()=> {
    document.querySelectorAll("#characters img").forEach(i=>i.classList.remove("selected"));
    img.classList.add("selected");
    selectedCharacter = img.dataset.name;
  });
});

document.getElementById("walletBtn").onclick = ()=>{mode="wallet"; startBtn.disabled=false;};
document.getElementById("demoBtn").onclick = ()=>{mode="demo"; startBtn.disabled=false;};

startBtn.onclick = ()=>{
  if(!mode) return alert("Seleziona una modalitÃ !");
  ws.send(JSON.stringify({type:"start", mode, character:selectedCharacter}));
  startBtn.disabled=true;
};

ws.onmessage = (msg)=>{
  const data = JSON.parse(msg.data);
  if(data.type==="online") onlineCounter.innerText="Online: "+data.count;
};
</script>
</body>
</html>